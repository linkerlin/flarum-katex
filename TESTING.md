# Flarum KaTeX Extension 测试指南

## 测试环境准备

1. 确保已安装Flarum 2.0+
2. 将修复后的扩展安装到Flarum的extensions目录中
3. 运行`composer install`安装PHP依赖
4. 进入js目录并运行`npm install`安装JavaScript依赖
5. 运行`npm run build`构建JavaScript文件

## 测试步骤

### 1. 基本功能测试

1. 在Flarum管理面板中启用KaTeX扩展
2. 检查扩展设置页面，确认以下配置选项存在：
   - 启用KaTeX数学渲染
   - 默认显示模式
   - 错误时抛出异常
   - 错误颜色
   - 数学分隔符
   - 自定义宏
   - 自动渲染CDN URL
   - 复制公式CDN URL

3. 创建一个包含数学公式的帖子，例如：
   ```
   当 \(a \ne 0\) 时，二次方程 \(ax^2 + bx + c = 0\) 的解为：
   
   $$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$
   ```

4. 查看帖子，确认数学公式正确渲染

### 2. CDN配置测试

1. 在扩展设置中修改自动渲染CDN URL或复制公式CDN URL
2. 保存设置并刷新页面
3. 检查浏览器开发者工具的网络选项卡，确认新的CDN URL被使用

### 3. 错误处理测试

1. 创建一个包含无效LaTeX代码的帖子
2. 检查是否正确显示错误信息而不是崩溃

### 4. 自定义宏测试

1. 在扩展设置中添加自定义宏，例如：
   ```json
   {"\\RR": "\\mathbb{R}", "\\NN": "\\mathbb{N}"}
   ```
2. 创建包含这些宏的帖子：
   ```
   实数集表示为 $\RR$，自然数集表示为 $\NN$。
   ```
3. 检查宏是否正确展开

## 预期结果

- 数学公式应正确渲染，无JavaScript错误
- 所有配置选项应正常工作
- CDN资源应正确加载，无完整性检查错误
- 错误处理应正常工作
- 自定义宏应正确展开

## 故障排除

如果遇到问题，请检查：

1. 浏览器开发者工具的控制台是否有错误信息
2. 网络选项卡中CDN资源是否正确加载
3. Flarum日志文件中是否有相关错误
4. 确认所有依赖都已正确安装和构建